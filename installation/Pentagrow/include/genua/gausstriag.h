
/* Copyright (C) 2015 David Eller <david@larosterna.com>
 * 
 * Commercial License Usage
 * Licensees holding valid commercial licenses may use this file in accordance
 * with the terms contained in their respective non-exclusive license agreement.
 * For further information contact david@larosterna.com .
 *
 * GNU General Public License Usage
 * Alternatively, this file may be used under the terms of the GNU General
 * Public License version 3.0 as published by the Free Software Foundation and
 * appearing in the file gpl.txt included in the packaging of this file.
 */
 
#ifndef GENUA_GAUSS_TRIAG_H
#define GENUA_GAUSS_TRIAG_H

/** \file gausstriag.h
 *  \brief Triangular Gauss integration rules.
 *
 * This file defines inline functions which implement Gauss integration rules
 * for triangles with 4-1024 integration points. The integration domain is
 * \f[
 *  u \in (0, 1-v), \quad v \in (0,1)
 * \f]
 *
 * \ingroup numerics
 * \sa hammertriag.h
 */

#include "defines.h"

template <class Functor, class ResultType>
void gint_triag2(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 4 points
  sum += 0.197168783648703*f(0.211324865405187, 0.166666666666667);
  sum += 0.197168783648703*f(0.211324865405187, 0.622008467928146);
  sum += 0.052831216351297*f(0.788675134594813, 0.044658198738520);
  sum += 0.052831216351297*f(0.788675134594813, 0.166666666666667);
}
template <class Functor, class ResultType>
void gint_triag3(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 9 points
  sum += 0.068464377671354*f(0.112701665379258, 0.100000000000000);
  sum += 0.109543004274166*f(0.112701665379258, 0.443649167310371);
  sum += 0.068464377671354*f(0.112701665379258, 0.787298334620742);
  sum += 0.061728395061728*f(0.500000000000000, 0.056350832689629);
  sum += 0.098765432098765*f(0.500000000000000, 0.250000000000000);
  sum += 0.061728395061728*f(0.500000000000000, 0.443649167310371);
  sum += 0.008696116155807*f(0.887298334620742, 0.012701665379258);
  sum += 0.013913785849291*f(0.887298334620742, 0.056350832689629);
  sum += 0.008696116155807*f(0.887298334620742, 0.100000000000000);
}
template <class Functor, class ResultType>
void gint_triag4(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 16 points
  sum += 0.028150383076926*f(0.069431844202974, 0.064611063213548);
  sum += 0.052775277354230*f(0.069431844202974, 0.307096311531159);
  sum += 0.052775277354230*f(0.069431844202974, 0.623471844265867);
  sum += 0.028150383076926*f(0.069431844202974, 0.865957092583479);
  sum += 0.037997147647950*f(0.330009478207572, 0.046518677526561);
  sum += 0.071235620499740*f(0.330009478207572, 0.221103222500738);
  sum += 0.071235620499740*f(0.330009478207572, 0.448887299291690);
  sum += 0.037997147647950*f(0.330009478207572, 0.623471844265867);
  sum += 0.018715815315013*f(0.669990521792428, 0.022913166676413);
  sum += 0.035087705252934*f(0.669990521792428, 0.108906255706834);
  sum += 0.035087705252934*f(0.669990521792428, 0.221103222500738);
  sum += 0.018715815315013*f(0.669990521792428, 0.307096311531159);
  sum += 0.002100365244475*f(0.930568155797026, 0.004820780989426);
  sum += 0.003937685608733*f(0.930568155797026, 0.022913166676413);
  sum += 0.003937685608733*f(0.930568155797026, 0.046518677526561);
  sum += 0.002100365244475*f(0.930568155797026, 0.064611063213548);
}
template <class Functor, class ResultType>
void gint_triag5(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 25 points
  sum += 0.013375270558306*f(0.046910077030668, 0.044709521703645);
  sum += 0.027020099316181*f(0.046910077030668, 0.219940124839679);
  sum += 0.032115573564809*f(0.046910077030668, 0.476544961484666);
  sum += 0.027020099316181*f(0.046910077030668, 0.733149798129653);
  sum += 0.013375270558306*f(0.046910077030668, 0.908380401265687);
  sum += 0.021807802470748*f(0.230765344947159, 0.036084856923188);
  sum += 0.044055107973971*f(0.230765344947159, 0.177512700518577);
  sum += 0.052363059235553*f(0.230765344947159, 0.384617327526421);
  sum += 0.044055107973971*f(0.230765344947159, 0.591721954534264);
  sum += 0.021807802470748*f(0.230765344947159, 0.733149798129653);
  sum += 0.016848134048440*f(0.500000000000000, 0.023455038515334);
  sum += 0.034035816568844*f(0.500000000000000, 0.115382672473579);
  sum += 0.040454320987654*f(0.500000000000000, 0.250000000000000);
  sum += 0.034035816568844*f(0.500000000000000, 0.384617327526421);
  sum += 0.016848134048440*f(0.500000000000000, 0.476544961484666);
  sum += 0.006542197529252*f(0.769234655052841, 0.010825220107480);
  sum += 0.013216243082027*f(0.769234655052841, 0.053252644428581);
  sum += 0.015708573902135*f(0.769234655052841, 0.115382672473579);
  sum += 0.013216243082027*f(0.769234655052841, 0.177512700518577);
  sum += 0.006542197529252*f(0.769234655052841, 0.219940124839679);
  sum += 0.000658316657301*f(0.953089922969332, 0.002200555327023);
  sum += 0.001329900683819*f(0.953089922969332, 0.010825220107480);
  sum += 0.001580694532071*f(0.953089922969332, 0.023455038515334);
  sum += 0.001329900683819*f(0.953089922969332, 0.036084856923188);
  sum += 0.000658316657301*f(0.953089922969332, 0.044709521703645);
}
template <class Functor, class ResultType>
void gint_triag6(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 36 points
  sum += 0.007090250380294*f(0.033765242898424, 0.032625151270434);
  sum += 0.014930088774693*f(0.033765242898424, 0.163675633088031);
  sum += 0.019364580664898*f(0.033765242898424, 0.367836302898351);
  sum += 0.019364580664898*f(0.033765242898424, 0.598398454203225);
  sum += 0.014930088774693*f(0.033765242898424, 0.802559124013545);
  sum += 0.007090250380294*f(0.033765242898424, 0.933609605831141);
  sum += 0.012834356987785*f(0.169395306766868, 0.028045569219588);
  sum += 0.027025574403730*f(0.169395306766868, 0.140700536812227);
  sum += 0.035052632536473*f(0.169395306766868, 0.316203238688479);
  sum += 0.035052632536473*f(0.169395306766868, 0.514401454544653);
  sum += 0.027025574403730*f(0.169395306766868, 0.689904156420906);
  sum += 0.012834356987785*f(0.169395306766868, 0.802559124013544);
  sum += 0.012411756545556*f(0.380690406958401, 0.020911138838374);
  sum += 0.026135695798563*f(0.380690406958401, 0.104908138496946);
  sum += 0.033898444755558*f(0.380690406958401, 0.235765221008248);
  sum += 0.033898444755558*f(0.380690406958401, 0.383544372033350);
  sum += 0.026135695798563*f(0.380690406958401, 0.514401454544653);
  sum += 0.012411756545556*f(0.380690406958401, 0.598398454203225);
  sum += 0.007629522783896*f(0.619309593041598, 0.012854104060050);
  sum += 0.016065645973334*f(0.619309593041598, 0.064487168269922);
  sum += 0.020837417786266*f(0.619309593041598, 0.144925185950153);
  sum += 0.020837417786266*f(0.619309593041598, 0.235765221008248);
  sum += 0.016065645973334*f(0.619309593041598, 0.316203238688479);
  sum += 0.007629522783896*f(0.619309593041598, 0.367836302898351);
  sum += 0.002617466355311*f(0.830604693233132, 0.005719673678836);
  sum += 0.005511653743312*f(0.830604693233132, 0.028694769954641);
  sum += 0.007148709235424*f(0.830604693233132, 0.064487168269922);
  sum += 0.007148709235424*f(0.830604693233132, 0.104908138496946);
  sum += 0.005511653743312*f(0.830604693233132, 0.140700536812226);
  sum += 0.002617466355311*f(0.830604693233132, 0.163675633088031);
  sum += 0.000247770041951*f(0.966234757101576, 0.001140091627990);
  sum += 0.000521734568403*f(0.966234757101576, 0.005719673678836);
  sum += 0.000676698664554*f(0.966234757101576, 0.012854104060050);
  sum += 0.000676698664554*f(0.966234757101576, 0.020911138838374);
  sum += 0.000521734568403*f(0.966234757101576, 0.028045569219588);
  sum += 0.000247770041951*f(0.966234757101576, 0.032625151270435);
}
template <class Functor, class ResultType>
void gint_triag7(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 49 points
  Real x, t;
  Real xp[] = {
    0.025446043828621,
    0.129234407200303,
    0.297077424311301,
    0.500000000000000,
    0.702922575688699,
    0.870765592799697,
    0.974553956171379,
  };
  Real wp[] = {
    0.064742483084435,
    0.139852695744638,
    0.190915025252559,
    0.208979591836735,
    0.190915025252559,
    0.139852695744638,
    0.064742483084435,
  };
  for (uint i=0; i<7; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<7; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag8(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 64 points
  Real x, t;
  Real xp[] = {
    0.019855071751232,
    0.101666761293187,
    0.237233795041836,
    0.408282678752175,
    0.591717321247825,
    0.762766204958164,
    0.898333238706813,
    0.980144928248768,
  };
  Real wp[] = {
    0.050614268145188,
    0.111190517226687,
    0.156853322938944,
    0.181341891689181,
    0.181341891689181,
    0.156853322938944,
    0.111190517226687,
    0.050614268145188,
  };
  for (uint i=0; i<8; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<8; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag9(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 81 points
  Real x, t;
  Real xp[] = {
    0.015919880246187,
    0.081984446336682,
    0.193314283649705,
    0.337873288298095,
    0.500000000000000,
    0.662126711701904,
    0.806685716350295,
    0.918015553663318,
    0.984080119753813,
  };
  Real wp[] = {
    0.040637194180787,
    0.090324080347429,
    0.130305348201468,
    0.156173538520001,
    0.165119677500630,
    0.156173538520001,
    0.130305348201468,
    0.090324080347429,
    0.040637194180787,
  };
  for (uint i=0; i<9; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<9; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag10(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 100 points
  Real x, t;
  Real xp[] = {
    0.013046735741414,
    0.067468316655508,
    0.160295215850488,
    0.283302302935376,
    0.425562830509184,
    0.574437169490816,
    0.716697697064624,
    0.839704784149512,
    0.932531683344492,
    0.986953264258586,
  };
  Real wp[] = {
    0.033335672154344,
    0.074725674575290,
    0.109543181257991,
    0.134633359654998,
    0.147762112357376,
    0.147762112357377,
    0.134633359654998,
    0.109543181257991,
    0.074725674575290,
    0.033335672154344,
  };
  for (uint i=0; i<10; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<10; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag11(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 121 points
  Real x, t;
  Real xp[] = {
    0.010885670926972,
    0.056468700115952,
    0.134923997212975,
    0.240451935396594,
    0.365228422023827,
    0.500000000000000,
    0.634771577976173,
    0.759548064603406,
    0.865076002787025,
    0.943531299884048,
    0.989114329073028,
  };
  Real wp[] = {
    0.027834283558087,
    0.062790184732452,
    0.093145105463867,
    0.116596882295995,
    0.131402272255123,
    0.136462543388950,
    0.131402272255123,
    0.116596882295995,
    0.093145105463867,
    0.062790184732452,
    0.027834283558087,
  };
  for (uint i=0; i<11; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<11; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag12(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 144 points
  Real x, t;
  Real xp[] = {
    0.009219682876640,
    0.047941371814763,
    0.115048662902848,
    0.206341022856691,
    0.316084250500910,
    0.437383295744266,
    0.562616704255734,
    0.683915749499090,
    0.793658977143309,
    0.884951337097152,
    0.952058628185237,
    0.990780317123360,
  };
  Real wp[] = {
    0.023587668193256,
    0.053469662997659,
    0.080039164271673,
    0.101583713361533,
    0.116746268269177,
    0.124573522906701,
    0.124573522906701,
    0.116746268269177,
    0.101583713361533,
    0.080039164271673,
    0.053469662997659,
    0.023587668193256,
  };
  for (uint i=0; i<12; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<12; ++j) {
      t = 0.5*(xp[j]+1.0)
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag13(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 169 points
  Real x, t;
  Real xp[] = {
    0.007908472640706,
    0.041200800388511,
    0.099210954633345,
    0.178825330279830,
    0.275753624481777,
    0.384770842022433,
    0.500000000000000,
    0.615229157977567,
    0.724246375518223,
    0.821174669720170,
    0.900789045366655,
    0.958799199611489,
    0.992091527359294,
  };
  Real wp[] = {
    0.020242002382658,
    0.046060749918864,
    0.069436755109894,
    0.089072990380973,
    0.103908023768444,
    0.113141590131449,
    0.116275776615437,
    0.113141590131448,
    0.103908023768444,
    0.089072990380973,
    0.069436755109893,
    0.046060749918864,
    0.020242002382658,
  };
  for (uint i=0; i<13; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<13; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag14(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 196 points
  Real x, t;
  Real xp[] = {
    0.006858095651594,
    0.035782558168213,
    0.086399342465117,
    0.156353547594157,
    0.242375681820923,
    0.340443815536055,
    0.445972525646328,
    0.554027474353672,
    0.659556184463945,
    0.757624318179077,
    0.843646452405843,
    0.913600657534883,
    0.964217441831787,
    0.993141904348406,
  };
  Real wp[] = {
    0.017559730165876,
    0.040079043579880,
    0.060759285343952,
    0.078601583579097,
    0.092769198738969,
    0.102599231860648,
    0.107631926731579,
    0.107631926731579,
    0.102599231860647,
    0.092769198738969,
    0.078601583579097,
    0.060759285343952,
    0.040079043579880,
    0.017559730165876,
  };
  for (uint i=0; i<14; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<14; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag15(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 225 points
  Real x, t;
  Real xp[] = {
    0.006003740989757,
    0.031363303799647,
    0.075896708294786,
    0.137791134319915,
    0.214513913695731,
    0.302924326461218,
    0.399402953001283,
    0.500000000000000,
    0.600597046998717,
    0.697075673538782,
    0.785486086304269,
    0.862208865680085,
    0.924103291705214,
    0.968636696200353,
    0.993996259010243,
  };
  Real wp[] = {
    0.015376620998059,
    0.035183023744054,
    0.053579610233586,
    0.069785338963077,
    0.083134602908497,
    0.093080500007781,
    0.099215742663556,
    0.101289120962781,
    0.099215742663556,
    0.093080500007781,
    0.083134602908497,
    0.069785338963077,
    0.053579610233586,
    0.035183023744054,
    0.015376620998059,
  };
  for (uint i=0; i<15; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<15; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag16(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 256 points
  Real x, t;
  Real xp[] = {
    0.005299532504175,
    0.027712488463384,
    0.067184398806084,
    0.122297795822498,
    0.191061877798678,
    0.270991611171386,
    0.359198224610370,
    0.452493745081181,
    0.547506254918819,
    0.640801775389630,
    0.729008388828614,
    0.808938122201322,
    0.877702204177502,
    0.932815601193916,
    0.972287511536616,
    0.994700467495825,
  };
  Real wp[] = {
    0.013576229705877,
    0.031126761969324,
    0.047579255841246,
    0.062314485627767,
    0.074797994408288,
    0.084578259697501,
    0.091301707522462,
    0.094725305227534,
    0.094725305227534,
    0.091301707522462,
    0.084578259697502,
    0.074797994408288,
    0.062314485627767,
    0.047579255841246,
    0.031126761969324,
    0.013576229705877,
  };
  for (uint i=0; i<16; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<16; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag17(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 289 points
  Real x, t;
  Real xp[] = {
    0.004712262342791,
    0.024662239115616,
    0.059880423136507,
    0.109242998051599,
    0.171164420391655,
    0.243654731456762,
    0.324384118273062,
    0.410757909252076,
    0.500000000000000,
    0.589242090747924,
    0.675615881726938,
    0.756345268543239,
    0.828835579608345,
    0.890757001948401,
    0.940119576863493,
    0.975337760884384,
    0.995287737657209,
  };
  Real wp[] = {
    0.012074151434274,
    0.027729764686994,
    0.042518074158590,
    0.055941923596702,
    0.067568184234263,
    0.077022880538405,
    0.084002051078225,
    0.088281352683496,
    0.089723235178103,
    0.088281352683496,
    0.084002051078225,
    0.077022880538405,
    0.067568184234263,
    0.055941923596702,
    0.042518074158590,
    0.027729764686994,
    0.012074151434274,
  };
  for (uint i=0; i<17; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<17; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag18(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 324 points
  Real x, t;
  Real xp[] = {
    0.004217415789534,
    0.022088025214301,
    0.053698766751222,
    0.098147520513738,
    0.154156478469823,
    0.220114584463026,
    0.294124419268579,
    0.374056887154247,
    0.457612493479132,
    0.542387506520868,
    0.625943112845753,
    0.705875580731421,
    0.779885415536974,
    0.845843521530177,
    0.901852479486262,
    0.946301233248778,
    0.977911974785699,
    0.995782584210466,
  };
  Real wp[] = {
    0.010808006763242,
    0.024857274447485,
    0.038212865127445,
    0.050471022053144,
    0.061277603355739,
    0.070321457335325,
    0.077342337563133,
    0.082138241872916,
    0.084571191481571,
    0.084571191481572,
    0.082138241872916,
    0.077342337563133,
    0.070321457335325,
    0.061277603355739,
    0.050471022053144,
    0.038212865127445,
    0.024857274447485,
    0.010808006763242,
  };
  for (uint i=0; i<18; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<18; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag19(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 361 points
  Real x, t;
  Real xp[] = {
    0.003796578078208,
    0.019895923932585,
    0.048422048192591,
    0.088642671731429,
    0.139516911332385,
    0.199727347669160,
    0.267714629312020,
    0.341717950018185,
    0.419820677179887,
    0.500000000000000,
    0.580179322820113,
    0.658282049981815,
    0.732285370687980,
    0.800272652330841,
    0.860483088667615,
    0.911357328268571,
    0.951577951807409,
    0.980104076067415,
    0.996203421921792,
  };
  Real wp[] = {
    0.009730894114863,
    0.022407113382850,
    0.034522271368821,
    0.045745010811225,
    0.055783322773667,
    0.064376981269668,
    0.071303351086803,
    0.076383021032930,
    0.079484421696977,
    0.080527224924392,
    0.079484421696977,
    0.076383021032930,
    0.071303351086803,
    0.064376981269668,
    0.055783322773667,
    0.045745010811225,
    0.034522271368821,
    0.022407113382850,
    0.009730894114863,
  };
  for (uint i=0; i<19; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<19; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag20(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 400 points
  Real x, t;
  Real xp[] = {
    0.003435700407453,
    0.018014036361043,
    0.043882785874337,
    0.080441514088891,
    0.126834046769925,
    0.181973159636742,
    0.244566499024586,
    0.313146955642290,
    0.386107074429177,
    0.461736739433251,
    0.538263260566749,
    0.613892925570823,
    0.686853044357710,
    0.755433500975414,
    0.818026840363258,
    0.873165953230076,
    0.919558485911109,
    0.956117214125663,
    0.981985963638957,
    0.996564299592548,
  };
  Real wp[] = {
    0.008807003569576,
    0.020300714900194,
    0.031336024167055,
    0.041638370788352,
    0.050965059908620,
    0.059097265980759,
    0.065844319224588,
    0.071048054659191,
    0.074586493236302,
    0.076376693565363,
    0.076376693565363,
    0.074586493236302,
    0.071048054659191,
    0.065844319224588,
    0.059097265980759,
    0.050965059908620,
    0.041638370788352,
    0.031336024167055,
    0.020300714900193,
    0.008807003569576,
  };
  for (uint i=0; i<20; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<20; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag21(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 441 points
  Real x, t;
  Real xp[] = {
    0.003123914689805,
    0.016386580716847,
    0.039950332924799,
    0.073318317708341,
    0.115780018262161,
    0.166430597901294,
    0.224190582056390,
    0.287828939896281,
    0.355989341598799,
    0.427219072919552,
    0.500000000000000,
    0.572780927080447,
    0.644010658401201,
    0.712171060103719,
    0.775809417943610,
    0.833569402098706,
    0.884219981737839,
    0.926681682291659,
    0.960049667075201,
    0.983613419283153,
    0.996876085310195,
  };
  Real wp[] = {
    0.008008614128887,
    0.018476894885426,
    0.028567212713429,
    0.038050056814190,
    0.046722211728017,
    0.054398649583574,
    0.060915708026864,
    0.066134469316669,
    0.069943697395537,
    0.072262201994985,
    0.073040566824845,
    0.072262201994985,
    0.069943697395537,
    0.066134469316669,
    0.060915708026864,
    0.054398649583574,
    0.046722211728017,
    0.038050056814190,
    0.028567212713429,
    0.018476894885426,
    0.008008614128887,
  };
  for (uint i=0; i<21; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<21; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag22(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 484 points
  Real x, t;
  Real xp[] = {
    0.002852707258800,
    0.014969751082286,
    0.036521613906413,
    0.067093711139850,
    0.106091597010396,
    0.152756368406659,
    0.206179798246544,
    0.265322081006621,
    0.329032089553958,
    0.396069786655889,
    0.465130363340139,
    0.534869636659861,
    0.603930213344111,
    0.670967910446042,
    0.734677918993378,
    0.793820201753456,
    0.847243631593341,
    0.893908402989604,
    0.932906288860150,
    0.963478386093587,
    0.985030248917714,
    0.997147292741200,
  };
  Real wp[] = {
    0.007313997649136,
    0.016887450792407,
    0.026146667576342,
    0.034898234212260,
    0.042970803108534,
    0.050207072221440,
    0.056466148040270,
    0.061626188405256,
    0.065586752393531,
    0.068270749173008,
    0.069625936427816,
    0.069625936427816,
    0.068270749173008,
    0.065586752393531,
    0.061626188405256,
    0.056466148040270,
    0.050207072221441,
    0.042970803108534,
    0.034898234212260,
    0.026146667576342,
    0.016887450792407,
    0.007313997649136,
  };
  for (uint i=0; i<22; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<22; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag23(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 529 points
  Real x, t;
  Real xp[] = {
    0.002615332501224,
    0.013728764390942,
    0.033514456586992,
    0.061623820864779,
    0.097555799190580,
    0.140669318434025,
    0.190195062118177,
    0.245249261076996,
    0.304849480984855,
    0.367932159514827,
    0.433371587850767,
    0.500000000000000,
    0.566628412149233,
    0.632067840485173,
    0.695150519015145,
    0.754750738923004,
    0.809804937881823,
    0.859330681565975,
    0.902444200809420,
    0.938376179135221,
    0.966485543413008,
    0.986271235609058,
    0.997384667498776,
  };
  Real wp[] = {
    0.006705929743571,
    0.015494002928490,
    0.024018835865542,
    0.032116210704263,
    0.039640705888360,
    0.046457883030017,
    0.052446045732271,
    0.057498320111206,
    0.061524542153365,
    0.064452861094041,
    0.066231019702348,
    0.066827286093053,
    0.066231019702348,
    0.064452861094041,
    0.061524542153365,
    0.057498320111206,
    0.052446045732271,
    0.046457883030017,
    0.039640705888360,
    0.032116210704263,
    0.024018835865543,
    0.015494002928490,
    0.006705929743571,
  };
  for (uint i=0; i<23; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<23; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag24(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 576 points
  Real x, t;
  Real xp[] = {
    0.002406390001489,
    0.012635722014345,
    0.030862723998634,
    0.056792236497800,
    0.089999007013049,
    0.129937904210723,
    0.175953174031512,
    0.227289264305580,
    0.283103246186977,
    0.342478660151918,
    0.404440566263192,
    0.467971553568697,
    0.532028446431303,
    0.595559433736808,
    0.657521339848082,
    0.716896753813023,
    0.772710735694420,
    0.824046825968488,
    0.870062095789277,
    0.910000992986951,
    0.943207763502200,
    0.969137276001366,
    0.987364277985655,
    0.997593609998511,
  };
  Real wp[] = {
    0.006170614899994,
    0.014265694314467,
    0.022138719408710,
    0.029649292457718,
    0.036673240705540,
    0.043095080765977,
    0.048809326052057,
    0.053722135057983,
    0.057752834026863,
    0.060835236463902,
    0.062918728173414,
    0.063969097673376,
    0.063969097673376,
    0.062918728173414,
    0.060835236463902,
    0.057752834026863,
    0.053722135057983,
    0.048809326052057,
    0.043095080765977,
    0.036673240705540,
    0.029649292457719,
    0.022138719408710,
    0.014265694314467,
    0.006170614899994,
  };
  for (uint i=0; i<24; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<24; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag25(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 625 points
  Real x, t;
  Real xp[] = {
    0.002221515104751,
    0.011668039270241,
    0.028512714385513,
    0.052504001060862,
    0.083278685619583,
    0.120370368481321,
    0.163216815763266,
    0.211168534879388,
    0.263498634277143,
    0.319413847095306,
    0.378066558139506,
    0.438567653694645,
    0.500000000000000,
    0.561432346305355,
    0.621933441860494,
    0.680586152904694,
    0.736501365722857,
    0.788831465120611,
    0.836783184236734,
    0.879629631518679,
    0.916721314380417,
    0.947495998939138,
    0.971487285614487,
    0.988331960729759,
    0.997778484895249,
  };
  Real wp[] = {
    0.005696899250513,
    0.013177493307516,
    0.020469578350653,
    0.027452347987918,
    0.034019166906178,
    0.040070350167501,
    0.045514130991482,
    0.050267974533525,
    0.054259812237132,
    0.057429129572856,
    0.059727881767892,
    0.061121221495155,
    0.061588026863358,
    0.061121221495155,
    0.059727881767892,
    0.057429129572856,
    0.054259812237132,
    0.050267974533525,
    0.045514130991482,
    0.040070350167501,
    0.034019166906178,
    0.027452347987918,
    0.020469578350653,
    0.013177493307516,
    0.005696899250513,
  };
  for (uint i=0; i<25; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<25; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag26(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 676 points
  Real x, t;
  Real xp[] = {
    0.002057149427191,
    0.010807277021764,
    0.026420466669143,
    0.048681069007846,
    0.077277028605751,
    0.111807025589661,
    0.151786369790021,
    0.196653853491191,
    0.245779642587747,
    0.298474122438257,
    0.353997580257022,
    0.411570589821555,
    0.470384953285343,
    0.529615046714657,
    0.588429410178445,
    0.646002419742978,
    0.701525877561743,
    0.754220357412253,
    0.803346146508809,
    0.848213630209979,
    0.888192974410339,
    0.922722971394249,
    0.951318930992153,
    0.973579533330857,
    0.989192722978235,
    0.997942850572808,
  };
  Real wp[] = {
    0.005275686308671,
    0.012208925546316,
    0.018981191647182,
    0.025487912648574,
    0.031637023164787,
    0.037342074882830,
    0.042522947156743,
    0.047106900177957,
    0.051029580547213,
    0.054235920264288,
    0.056680908273160,
    0.058330221742648,
    0.059160707639631,
    0.059160707639631,
    0.058330221742648,
    0.056680908273160,
    0.054235920264288,
    0.051029580547213,
    0.047106900177957,
    0.042522947156743,
    0.037342074882830,
    0.031637023164787,
    0.025487912648574,
    0.018981191647182,
    0.012208925546316,
    0.005275686308671,
  };
  for (uint i=0; i<26; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<26; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag27(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 729 points
  Real x, t;
  Real xp[] = {
    0.001910368555506,
    0.010038262019249,
    0.024549721092647,
    0.045258839661254,
    0.071896045990853,
    0.104114180464746,
    0.141493263130288,
    0.183546014026752,
    0.229724217710272,
    0.279425874124987,
    0.332003048180746,
    0.386770317280232,
    0.443013707195235,
    0.500000000000000,
    0.556986292804765,
    0.613229682719769,
    0.667996951819255,
    0.720574125875014,
    0.770275782289729,
    0.816453985973248,
    0.858506736869712,
    0.895885819535254,
    0.928103954009147,
    0.954741160338745,
    0.975450278907352,
    0.989961737980751,
    0.998089631444494,
  };
  Real wp[] = {
    0.004899498025647,
    0.011343115798090,
    0.017648526878710,
    0.023724706260308,
    0.029491768429917,
    0.034874411883123,
    0.039802433886529,
    0.044211579271878,
    0.048044363685014,
    0.051250818908873,
    0.053789142894267,
    0.055626244178423,
    0.056738173054483,
    0.057110433689478,
    0.056738173054482,
    0.055626244178423,
    0.053789142894267,
    0.051250818908873,
    0.048044363685014,
    0.044211579271879,
    0.039802433886529,
    0.034874411883123,
    0.029491768429917,
    0.023724706260308,
    0.017648526878710,
    0.011343115798090,
    0.004899498025647,
  };
  for (uint i=0; i<27; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<27; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag28(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 784 points
  Real x, t;
  Real xp[] = {
    0.001778751213023,
    0.009348417314564,
    0.022870359685531,
    0.042183486803934,
    0.067053738712803,
    0.097179314541410,
    0.132194560993184,
    0.171674452980568,
    0.215139764094299,
    0.262062887522441,
    0.311874241955461,
    0.363969186182411,
    0.417715358933310,
    0.472460355057983,
    0.527539644942017,
    0.582284641066690,
    0.636030813817589,
    0.688125758044539,
    0.737937112477559,
    0.784860235905701,
    0.828325547019432,
    0.867805439006816,
    0.902820685458590,
    0.932946261287197,
    0.957816513196066,
    0.977129640314469,
    0.990651582685436,
    0.998221248786977,
  };
  Real wp[] = {
    0.004562141296547,
    0.010566056296386,
    0.016450713891152,
    0.022136467379502,
    0.027553672837858,
    0.032636461983500,
    0.037323107117284,
    0.041556708614451,
    0.045285872196516,
    0.048465328998965,
    0.051056483789031,
    0.053027882961423,
    0.054355596129147,
    0.055023506508238,
    0.055023506508238,
    0.054355596129147,
    0.053027882961423,
    0.051056483789031,
    0.048465328998965,
    0.045285872196517,
    0.041556708614450,
    0.037323107117284,
    0.032636461983500,
    0.027553672837858,
    0.022136467379502,
    0.016450713891152,
    0.010566056296386,
    0.004562141296547,
  };
  for (uint i=0; i<28; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<28; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag29(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 841 points
  Real x, t;
  Real xp[] = {
    0.001660278869702,
    0.008727247369293,
    0.021357202110956,
    0.039409883523471,
    0.062681097539949,
    0.090907256192374,
    0.123768574132761,
    0.160892731198657,
    0.201859101430886,
    0.246203522437886,
    0.293423555912996,
    0.342984181066180,
    0.394323856917000,
    0.446860884933660,
    0.500000000000000,
    0.553139115066340,
    0.605676143083001,
    0.657015818933820,
    0.706576444087004,
    0.753796477562114,
    0.798140898569114,
    0.839107268801343,
    0.876231425867239,
    0.909092743807626,
    0.937318902460051,
    0.960590116476529,
    0.978642797889044,
    0.991272752630707,
    0.998339721130298,
  };
  Real wp[] = {
    0.004258451939373,
    0.009866042528062,
    0.015370246101047,
    0.020701031259342,
    0.025797413451249,
    0.030601545328539,
    0.035058966627526,
    0.039119163567882,
    0.042736128683086,
    0.045868878569629,
    0.048481917047204,
    0.050545636879958,
    0.052036655038865,
    0.052938077548660,
    0.053239690859157,
    0.052938077548660,
    0.052036655038865,
    0.050545636879957,
    0.048481917047204,
    0.045868878569629,
    0.042736128683086,
    0.039119163567882,
    0.035058966627526,
    0.030601545328539,
    0.025797413451249,
    0.020701031259342,
    0.015370246101047,
    0.009866042528061,
    0.004258451939373,
  };
  for (uint i=0; i<29; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<29; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag30(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 900 points
  Real x, t;
  Real xp[] = {
    0.001553257962675,
    0.008165938360126,
    0.019989067515846,
    0.036899976285363,
    0.058719732103974,
    0.085217118808616,
    0.116111283947587,
    0.151074752603342,
    0.189736908505379,
    0.231687925928990,
    0.276483115230955,
    0.323647637234561,
    0.372681536916055,
    0.423065043195708,
    0.474264078722341,
    0.525735921277659,
    0.576934956804292,
    0.627318463083945,
    0.676352362765439,
    0.723516884769045,
    0.768312074071010,
    0.810263091494621,
    0.848925247396658,
    0.883888716052413,
    0.914782881191384,
    0.941280267896026,
    0.963100023714637,
    0.980010932484154,
    0.991834061639874,
    0.998446742037325,
  };
  Real wp[] = {
    0.003984096248083,
    0.009233234155545,
    0.014392353941662,
    0.019399596284814,
    0.024201336415297,
    0.028746578108809,
    0.032987114941090,
    0.036877987368853,
    0.040377947614710,
    0.043449893600541,
    0.046061261118893,
    0.048184368587322,
    0.049796710293398,
    0.050881194874203,
    0.051426326446779,
    0.051426326446779,
    0.050881194874203,
    0.049796710293398,
    0.048184368587322,
    0.046061261118893,
    0.043449893600542,
    0.040377947614710,
    0.036877987368852,
    0.032987114941090,
    0.028746578108809,
    0.024201336415297,
    0.019399596284814,
    0.014392353941662,
    0.009233234155545,
    0.003984096248083,
  };
  for (uint i=0; i<30; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<30; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag31(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 961 points
  Real x, t;
  Real xp[] = {
    0.001456259090261,
    0.007657045167424,
    0.018748037453525,
    0.034621501051676,
    0.055119985025864,
    0.080039839926866,
    0.109133425791688,
    0.142111607706573,
    0.178646638537870,
    0.218375419296425,
    0.260903108977549,
    0.305807049195884,
    0.352640965009149,
    0.400939400332215,
    0.450222343923829,
    0.500000000000000,
    0.549777656076171,
    0.599060599667785,
    0.647359034990851,
    0.694192950804116,
    0.739096891022451,
    0.781624580703575,
    0.821353361462130,
    0.857888392293427,
    0.890866574208312,
    0.919960160073134,
    0.944880014974135,
    0.965378498948324,
    0.981251962546475,
    0.992342954832576,
    0.998543740909739,
  };
  Real wp[] = {
    0.003735415789624,
    0.008659310395155,
    0.013504509592490,
    0.018216136956193,
    0.022746853763601,
    0.027051541212459,
    0.031087393280514,
    0.034814291617705,
    0.038195193299388,
    0.041196495880795,
    0.043788370304239,
    0.045945056946821,
    0.047645121456160,
    0.048871667693164,
    0.049612505613336,
    0.049860272396713,
    0.049612505613336,
    0.048871667693164,
    0.047645121456160,
    0.045945056946821,
    0.043788370304239,
    0.041196495880795,
    0.038195193299388,
    0.034814291617705,
    0.031087393280514,
    0.027051541212458,
    0.022746853763601,
    0.018216136956193,
    0.013504509592489,
    0.008659310395155,
    0.003735415789624,
  };
  for (uint i=0; i<31; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<31; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}
template <class Functor, class ResultType>
void gint_triag32(Functor &&f, ResultType & sum)
{
  // gauss triangular integration (u=0..1-v, v=0..1) for 1024 points
  Real x, t;
  Real xp[] = {
    0.001368069075259,
    0.007194244227366,
    0.017618872206247,
    0.032546962031130,
    0.051839422116974,
    0.075316193133715,
    0.102758102016029,
    0.133908940629855,
    0.168477866534892,
    0.206142121379619,
    0.246550045533885,
    0.289324361934682,
    0.334065698858936,
    0.380356318873932,
    0.427764019208602,
    0.475846167156131,
    0.524153832843869,
    0.572235980791398,
    0.619643681126068,
    0.665934301141064,
    0.710675638065318,
    0.753449954466115,
    0.793857878620381,
    0.831522133465108,
    0.866091059370145,
    0.897241897983971,
    0.924683806866285,
    0.948160577883026,
    0.967453037968870,
    0.982381127793753,
    0.992805755772634,
    0.998631930924741,
  };
  Real wp[] = {
    0.003509305004735,
    0.008137197365453,
    0.012696032654631,
    0.017136931456511,
    0.021417949011113,
    0.025499029631188,
    0.029342046739268,
    0.032911111388181,
    0.036172897054424,
    0.039096947893535,
    0.041655962113473,
    0.043826046502202,
    0.045586939347882,
    0.046922199540402,
    0.047819360039637,
    0.048270044257364,
    0.048270044257364,
    0.047819360039637,
    0.046922199540402,
    0.045586939347882,
    0.043826046502202,
    0.041655962113473,
    0.039096947893535,
    0.036172897054424,
    0.032911111388181,
    0.029342046739267,
    0.025499029631188,
    0.021417949011113,
    0.017136931456511,
    0.012696032654631,
    0.008137197365453,
    0.003509305004735,
  };
  for (uint i=0; i<32; ++i) {
    x = 0.5*(xp[i]+1.0);
    for (uint j=0; j<32; ++j) {
      t = 0.5*(xp[j]+1.0);
      sum += wp[i] * wp[j] * (1.-x) * f(x,t*(1.-x));
    }
  }
}

#endif

